<!doctype html>
<html lang="zh-TW">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Fred's ç°¡å ±èª²ç¨‹å¹³å°</title>
		<style>
			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Design Tokens - Vercel/Geist Style
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			:root {
				/* Background colors */
				--bg-primary: #0a0a0a;
				--bg-secondary: #111111;
				--bg-tertiary: #171717;
				--bg-hover: #1a1a1a;
				--bg-active: #252525;

				/* Border colors */
				--border-default: #2e2e2e;
				--border-hover: #3e3e3e;
				--border-focus: #525252;

				/* Text colors */
				--text-primary: #ededed;
				--text-secondary: #a1a1a1;
				--text-tertiary: #737373;
				--text-disabled: #525252;

				/* Accent colors */
				--accent-primary: #f97316;
				--accent-primary-hover: #ea580c;
				--accent-secondary: #3b82f6;
				--accent-success: #22c55e;
				--accent-warning: #eab308;
				--accent-error: #ef4444;

				/* Accent surfaces (with transparency) */
				--accent-success-surface: rgba(34, 197, 94, 0.15);
				--accent-warning-surface: rgba(234, 179, 8, 0.15);
				--accent-error-surface: rgba(239, 68, 68, 0.15);
				--accent-primary-surface: rgba(249, 115, 22, 0.15);

				/* Typography */
				--font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
				--font-mono: 'SF Mono', 'Fira Code', 'Fira Mono', Menlo, Monaco, Consolas, monospace;

				/* Spacing */
				--radius-sm: 6px;
				--radius-md: 8px;
				--radius-lg: 12px;
				--radius-xl: 16px;

				/* Shadows */
				--shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
				--shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
				--shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Base Styles
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: var(--font-sans);
				background: var(--bg-primary);
				min-height: 100vh;
				color: var(--text-primary);
				line-height: 1.5;
				-webkit-font-smoothing: antialiased;
				-moz-osx-font-smoothing: grayscale;
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Layout
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			.container {
				max-width: 1200px;
				margin: 0 auto;
				padding: 48px 24px;
			}

			header {
				text-align: center;
				margin-bottom: 48px;
			}

			h1 {
				font-size: 2.5rem;
				font-weight: 700;
				color: var(--text-primary);
				margin-bottom: 8px;
				letter-spacing: -0.02em;
			}

			.subtitle {
				font-size: 1rem;
				color: var(--text-secondary);
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Course Cards Grid
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			.grid {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
				gap: 16px;
			}

			.card {
				background: var(--bg-secondary);
				border: 1px solid var(--border-default);
				border-radius: var(--radius-lg);
				padding: 24px;
				transition: all 0.2s ease;
				cursor: pointer;
				text-decoration: none;
				color: inherit;
				display: block;
			}

			.card:hover {
				background: var(--bg-hover);
				border-color: var(--border-hover);
				transform: translateY(-2px);
				box-shadow: var(--shadow-md);
			}

			.card:active {
				transform: translateY(0);
			}

			.icon {
				font-size: 2.5rem;
				margin-bottom: 16px;
			}

			.name {
				font-size: 1.25rem;
				font-weight: 600;
				margin-bottom: 8px;
				color: var(--text-primary);
			}

			.desc {
				color: var(--text-secondary);
				font-size: 0.875rem;
				line-height: 1.6;
			}

			.loading {
				text-align: center;
				padding: 48px;
				color: var(--text-tertiary);
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Admin Panel
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			.admin-panel {
				background: var(--bg-secondary);
				border: 1px solid var(--border-default);
				border-radius: var(--radius-xl);
				padding: 24px;
				margin-top: 48px;
			}

			.admin-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 20px;
				padding-bottom: 16px;
				border-bottom: 1px solid var(--border-default);
			}

			.admin-title {
				font-size: 1.125rem;
				font-weight: 600;
				display: flex;
				align-items: center;
				gap: 10px;
				color: var(--text-primary);
			}

			.admin-buttons {
				display: flex;
				gap: 8px;
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Buttons
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			.btn {
				padding: 10px 16px;
				border: none;
				border-radius: var(--radius-md);
				font-size: 0.875rem;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.15s ease;
				display: inline-flex;
				align-items: center;
				justify-content: center;
				gap: 6px;
				font-family: var(--font-sans);
			}

			.btn-primary {
				background: var(--accent-primary);
				color: white;
			}

			.btn-primary:hover {
				background: var(--accent-primary-hover);
				box-shadow: 0 0 0 3px var(--accent-primary-surface);
			}

			.btn-primary:disabled {
				opacity: 0.5;
				cursor: not-allowed;
			}

			.btn-secondary {
				background: var(--bg-tertiary);
				color: var(--text-secondary);
				border: 1px solid var(--border-default);
			}

			.btn-secondary:hover {
				background: var(--bg-hover);
				color: var(--text-primary);
				border-color: var(--border-hover);
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Status List
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			.status-list {
				display: flex;
				flex-direction: column;
				gap: 4px;
				max-height: 320px;
				overflow-y: auto;
			}

			.status-list::-webkit-scrollbar {
				width: 6px;
			}

			.status-list::-webkit-scrollbar-track {
				background: var(--bg-tertiary);
				border-radius: 3px;
			}

			.status-list::-webkit-scrollbar-thumb {
				background: var(--border-default);
				border-radius: 3px;
			}

			.status-list::-webkit-scrollbar-thumb:hover {
				background: var(--border-hover);
			}

			.status-item {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 12px 16px;
				background: var(--bg-tertiary);
				border-radius: var(--radius-md);
				font-family: var(--font-mono);
				font-size: 0.8125rem;
				transition: background 0.15s ease;
			}

			.status-item:hover {
				background: var(--bg-hover);
			}

			.status-item span:first-child {
				color: var(--text-secondary);
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Status Badges
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			.status-badge {
				padding: 4px 10px;
				border-radius: 9999px;
				font-size: 0.75rem;
				font-weight: 500;
				font-family: var(--font-sans);
			}

			.status-built {
				background: var(--accent-success-surface);
				color: var(--accent-success);
			}

			.status-needs-rebuild {
				background: var(--accent-warning-surface);
				color: var(--accent-warning);
			}

			.status-not-built {
				background: var(--accent-error-surface);
				color: var(--accent-error);
			}

			.status-building {
				background: var(--accent-primary-surface);
				color: var(--accent-primary);
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Progress Bar
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			.progress-container {
				margin: 20px 0;
				display: none;
			}

			.progress-bar {
				height: 4px;
				background: var(--bg-tertiary);
				border-radius: 2px;
				overflow: hidden;
			}

			.progress-fill {
				height: 100%;
				background: var(--accent-primary);
				transition: width 0.3s ease;
				width: 0%;
			}

			.progress-text {
				text-align: center;
				margin-top: 12px;
				font-size: 0.875rem;
				color: var(--text-secondary);
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Deploy Log
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			.deploy-log {
				margin-top: 16px;
				padding: 16px;
				background: var(--bg-primary);
				border: 1px solid var(--border-default);
				border-radius: var(--radius-md);
				font-family: var(--font-mono);
				font-size: 0.8125rem;
				max-height: 180px;
				overflow-y: auto;
				display: none;
			}

			.deploy-log::-webkit-scrollbar {
				width: 6px;
			}

			.deploy-log::-webkit-scrollbar-track {
				background: var(--bg-tertiary);
				border-radius: 3px;
			}

			.deploy-log::-webkit-scrollbar-thumb {
				background: var(--border-default);
				border-radius: 3px;
			}

			.log-entry {
				padding: 3px 0;
				color: var(--text-secondary);
			}

			.log-error {
				color: var(--accent-error);
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Footer
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			footer {
				text-align: center;
				margin-top: 64px;
				padding-top: 24px;
				border-top: 1px solid var(--border-default);
				color: var(--text-tertiary);
				font-size: 0.875rem;
			}

			footer a {
				color: var(--text-secondary);
				text-decoration: none;
				transition: color 0.15s ease;
			}

			footer a:hover {
				color: var(--text-primary);
			}

			/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
			   Responsive
			   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
			@media (max-width: 640px) {
				.container {
					padding: 24px 16px;
				}

				h1 {
					font-size: 1.75rem;
				}

				.grid {
					grid-template-columns: 1fr;
				}

				.admin-header {
					flex-direction: column;
					gap: 16px;
					align-items: flex-start;
				}

				.admin-buttons {
					width: 100%;
				}

				.admin-buttons .btn {
					flex: 1;
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<header>
				<h1 id="title">ç°¡å ±èª²ç¨‹å¹³å°</h1>
				<p class="subtitle" id="subtitle">è¼‰å…¥ä¸­...</p>
			</header>

			<div class="grid" id="container">
				<div class="loading">è¼‰å…¥èª²ç¨‹ä¸­...</div>
			</div>

			<!-- ç®¡ç†é¢æ¿ -->
			<div class="admin-panel" id="adminPanel">
				<div class="admin-header">
					<h2 class="admin-title">
						<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<circle cx="12" cy="12" r="3"></circle>
							<path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
						</svg>
						ç®¡ç†é¢æ¿
					</h2>
					<div class="admin-buttons">
						<button class="btn btn-primary" id="deployBtn" onclick="startDeploy()">
							<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
								<path d="M22 2L11 13"></path>
								<path d="M22 2L15 22L11 13L2 9L22 2Z"></path>
							</svg>
							éƒ¨ç½²å…¨éƒ¨
						</button>
						<button class="btn btn-secondary" onclick="refreshStatus()">
							<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
								<path d="M21 2v6h-6"></path>
								<path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path>
								<path d="M3 22v-6h6"></path>
								<path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path>
							</svg>
							é‡æ–°æ•´ç†
						</button>
					</div>
				</div>

				<div class="progress-container" id="progressContainer">
					<div class="progress-bar">
						<div class="progress-fill" id="progressFill"></div>
					</div>
					<div class="progress-text" id="progressText">æº–å‚™ä¸­...</div>
				</div>

				<div class="deploy-log" id="deployLog"></div>

				<div class="status-list" id="statusList">
					<div class="loading">è¼‰å…¥ç‹€æ…‹ä¸­...</div>
				</div>
			</div>

			<footer>
				<p>
					ç¶ äº¦æœ‰é™å…¬å¸ Â·
					<a href="https://andgreen.vzy.io" target="_blank">andgreen.vzy.io</a>
				</p>
			</footer>
		</div>

		<script>
			async function loadData() {
				try {
					const response = await fetch("courses.json");
					const data = await response.json();

					document.getElementById("title").textContent =
						data.title || "ç°¡å ±èª²ç¨‹å¹³å°";
					document.getElementById("subtitle").textContent = "è«‹é¸æ“‡èª²ç¨‹é¡åˆ¥";

					const container = document.getElementById("container");
					container.innerHTML = data.courses
						.map(
							(course) => `
                    <a href="${course.folder}/" class="card">
                        <div class="icon">${course.icon}</div>
                        <h2 class="name">${course.name}</h2>
                        <p class="desc">${course.description}</p>
                    </a>
                `
						)
						.join("");

					// Add "new course" placeholder
					/*
                container.innerHTML += `
                    <div class="card" style="border-style: dashed; opacity: 0.5;" onclick="alert('è«‹åŸ·è¡Œ scripts/new-course.sh å»ºç«‹æ–°èª²ç¨‹')">
                        <div class="icon">â•</div>
                        <h2 class="name">æ–°å¢èª²ç¨‹</h2>
                        <p class="desc">å»ºç«‹æ–°çš„èª²ç¨‹é¡åˆ¥</p>
                    </div>
                `;
                */
				} catch (error) {
					console.error("è¼‰å…¥å¤±æ•—:", error);
					document.getElementById("container").innerHTML =
						'<div class="loading">è¼‰å…¥å¤±æ•— (courses.json)</div>';
				}
			}
			loadData();

			// API åŸºç¤ URLï¼ˆé–‹ç™¼æ™‚ä½¿ç”¨ 3002 ç«¯å£ï¼‰
			const API_BASE = window.location.port === '3002' ? '' : 'http://localhost:3002';

			// è¼‰å…¥å»ºç½®ç‹€æ…‹
			async function refreshStatus() {
				const statusList = document.getElementById('statusList');
				statusList.innerHTML = '<div class="loading">è¼‰å…¥ç‹€æ…‹ä¸­...</div>';

				try {
					const response = await fetch(`${API_BASE}/api/status`);
					const data = await response.json();

					if (data.courses.length === 0) {
						statusList.innerHTML = '<div class="loading">æ²’æœ‰æ‰¾åˆ°ä»»ä½•ç°¡å ±</div>';
						return;
					}

					statusList.innerHTML = data.courses.map(item => {
						let statusClass = 'status-not-built';
						let statusText = 'âŒ æœªå»ºç½®';

						if (item.status === 'built') {
							if (item.needsRebuild) {
								statusClass = 'status-needs-rebuild';
								statusText = 'âš ï¸ éœ€æ›´æ–°';
							} else {
								statusClass = 'status-built';
								statusText = 'âœ… å·²å»ºç½®';
							}
						}

						return `
							<div class="status-item">
								<span>${item.path}</span>
								<span class="status-badge ${statusClass}">${statusText}</span>
							</div>
						`;
					}).join('');
				} catch (error) {
					console.error('è¼‰å…¥ç‹€æ…‹å¤±æ•—:', error);
					statusList.innerHTML = '<div class="loading">è¼‰å…¥å¤±æ•— - è«‹ç¢ºèª API æœå‹™å·²å•Ÿå‹• (npm run dev)</div>';
				}
			}

			// é–‹å§‹éƒ¨ç½²
			async function startDeploy() {
				const deployBtn = document.getElementById('deployBtn');
				const progressContainer = document.getElementById('progressContainer');
				const progressFill = document.getElementById('progressFill');
				const progressText = document.getElementById('progressText');
				const deployLog = document.getElementById('deployLog');
				const statusList = document.getElementById('statusList');

				deployBtn.disabled = true;
				deployBtn.innerHTML = 'â³ éƒ¨ç½²ä¸­...';
				progressContainer.style.display = 'block';
				deployLog.style.display = 'block';
				deployLog.innerHTML = '';

				const addLog = (message, isError = false) => {
					const entry = document.createElement('div');
					entry.className = 'log-entry' + (isError ? ' log-error' : '');
					entry.textContent = message;
					deployLog.appendChild(entry);
					deployLog.scrollTop = deployLog.scrollHeight;
				};

				try {
					const response = await fetch(`${API_BASE}/api/deploy`, {
						method: 'POST',
						headers: { 'Content-Type': 'application/json' }
					});

					const reader = response.body.getReader();
					const decoder = new TextDecoder();

					let totalItems = 0;
					let completedItems = 0;

					while (true) {
						const { done, value } = await reader.read();
						if (done) break;

						const text = decoder.decode(value);
						const lines = text.split('\n').filter(line => line.startsWith('data: '));

						for (const line of lines) {
							try {
								const data = JSON.parse(line.slice(6));

								switch (data.type) {
									case 'start':
										totalItems = data.total;
										addLog(`é–‹å§‹éƒ¨ç½² ${totalItems} å€‹ç°¡å ±...`);
										break;

									case 'building':
										progressText.textContent = `æ­£åœ¨å»ºç½® ${data.item} (${data.current}/${data.total})`;
										addLog(`ğŸ”¨ å»ºç½® ${data.item}...`);
										break;

									case 'built':
										completedItems++;
										const percent = Math.round((completedItems / totalItems) * 100);
										progressFill.style.width = percent + '%';
										if (data.success) {
											addLog(`âœ… ${data.item} å®Œæˆ`);
										} else {
											addLog(`âŒ ${data.item} å¤±æ•—`, true);
										}
										break;

									case 'git':
										progressText.textContent = 'æ­£åœ¨æ¨é€åˆ° GitHub...';
										addLog('ğŸ“¤ æ¨é€åˆ° GitHub...');
										break;

									case 'complete':
										if (data.success) {
											progressFill.style.width = '100%';
											progressText.textContent = 'âœ… éƒ¨ç½²å®Œæˆï¼';
											addLog('ğŸ‰ éƒ¨ç½²æˆåŠŸå®Œæˆï¼');
										} else {
											progressText.textContent = 'âš ï¸ éƒ¨ç½²å®Œæˆï¼ˆGit push å¤±æ•—ï¼‰';
											addLog('âš ï¸ Git push å¤±æ•—: ' + (data.message || ''), true);
										}
										break;

									case 'log':
										if (data.message.trim()) {
											addLog(data.message.trim(), data.error);
										}
										break;

									case 'error':
										addLog('âŒ éŒ¯èª¤: ' + data.message, true);
										break;
								}
							} catch (e) {
								// å¿½ç•¥è§£æéŒ¯èª¤
							}
						}
					}
				} catch (error) {
					console.error('éƒ¨ç½²å¤±æ•—:', error);
					addLog('âŒ éƒ¨ç½²å¤±æ•—: ' + error.message, true);
					progressText.textContent = 'âŒ éƒ¨ç½²å¤±æ•—';
				}

				deployBtn.disabled = false;
				deployBtn.innerHTML = 'ğŸš€ éƒ¨ç½²å…¨éƒ¨';
				refreshStatus();
			}

			// é é¢è¼‰å…¥æ™‚å˜—è©¦è¼‰å…¥ç‹€æ…‹
			setTimeout(refreshStatus, 500);
		</script>
	</body>
</html>
